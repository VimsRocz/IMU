Ensured 'results/' directory exists.
Running attitude-estimation method: SVD
TASK 1 (SVD): Define reference vectors in NED frame
Subtask 1.1: Setting initial latitude and longitude from GNSS ECEF data.
GNSS data columns:
    'UTC_yyyy'
    'UTC_MM'
    'UTC_dd'
    'UTC_HH'
    'UTC_mm'
    'UTC_ss'
    'Posix_Time'
    'Latitude_deg'
    'Longitude_deg'
    'Height_deg'
    'X_ECEF_m'
    'Y_ECEF_m'
    'Z_ECEF_m'
    'VX_ECEF_mps'
    'VY_ECEF_mps'
    'VZ_ECEF_mps'
    'HDOP'
    'VDOP'
    'PDOP'
    'TDOP'
First few rows of ECEF coordinates:
     X_ECEF_m     Y_ECEF_m      Z_ECEF_m
-3.729052e+06 3.935675e+06 -3.348392e+06
-3.729050e+06 3.935676e+06 -3.348394e+06
-3.729051e+06 3.935671e+06 -3.348399e+06
-3.729050e+06 3.935675e+06 -3.348393e+06
-3.729051e+06 3.935676e+06 -3.348392e+06
Subtask 1.2: Defining gravity vector in NED frame.
[Gravity Validation] Latitude: -31.871 deg, altitude: 158.8 m --> Gravity: 9.794248 m/s^2 (NED +Z is down)
Subtask 1.3: Defining Earth rotation rate vector in NED frame.
Subtask 1.4: Validating reference vectors.
Reference vectors validated successfully.
Computed initial latitude: -31.871173°, longitude: 133.455811° from GNSS
==== Reference Vectors in NED Frame ====
Gravity vector (NED):        [0.         0.         9.79424753] m/s^2
Earth rotation rate (NED):   [6.19272441e-05 0.00000000e+00 3.85030996e-05] rad/s
Latitude (deg):              -31.871173
Longitude (deg):             133.455811
Skipping plot generation (--no-plots)
TASK 2: Measure the vectors in the body frame
Static interval indices: 296 to 479907 (479611 samples)
Static interval duration: 1199.03 s of 1250.00 s total (95.9%)
Static interval covers 95.9% of the dataset. Verify motion data or adjust detection thresholds.
Task 2 vectors: g_body=[-9.5226e+00  2.7479e-05  2.2908e+00], omega_ie_body=[-2.3230e-05 -2.8021e-06  6.9001e-05]
Task 2: static interval = 296:479907, g_body = [-9.52258818e+00  2.74785412e-05  2.29076387e+00], omega_ie_body = [-2.32300437e-05 -2.80207333e-06  6.90007293e-05]
Estimated IMU dt: 0.002500 s
Gravity vector (body): [-9.52258818e+00  2.74785412e-05  2.29076387e+00]
Earth rotation (body): [-2.32300437e-05 -2.80207333e-06  6.90007293e-05]
TASK 3: Solve Wahba’s problem (find initial attitude from body to NED)
Subtask 3.1: Preparing vector pairs for attitude determination.
Subtask 3.2: Computing rotation matrix using TRIAD method.
Rotation matrix (TRIAD method, Case 1):
[[ 2.33646980e-01 -4.54035202e-02  9.71260835e-01]
 [ 1.06220955e-02  9.98968728e-01  4.41435243e-02]
 [-9.72263472e-01  2.82418914e-06  2.33888307e-01]]
Rotation matrix (TRIAD method, Case 2):
[[ 2.33646980e-01 -4.54035202e-02  9.71260835e-01]
 [ 1.06220955e-02  9.98968728e-01  4.41435243e-02]
 [-9.72263472e-01  2.82418914e-06  2.33888307e-01]]
Subtask 3.3: Computing rotation matrix using Davenport’s Q-Method.
Rotation matrix (Davenport’s Q-Method, Case 1):
[[ 2.33646980e-01 -4.54035202e-02  9.71260835e-01]
 [ 1.06220955e-02  9.98968728e-01  4.41435243e-02]
 [-9.72263472e-01  2.82418914e-06  2.33888307e-01]]
Davenport quaternion (q_w, q_x, q_y, q_z, Case 1): [ 0.78525537 -0.01405298  0.61875549  0.01783675]
Rotation matrix (Davenport’s Q-Method, Case 2):
[[ 2.33646980e-01 -4.54035202e-02  9.71260835e-01]
 [ 1.06220955e-02  9.98968728e-01  4.41435243e-02]
 [-9.72263472e-01  2.82418914e-06  2.33888307e-01]]
Davenport quaternion (q_w, q_x, q_y, q_z, Case 2): [ 0.78525537 -0.01405298  0.61875549  0.01783675]
Subtask 3.4: Computing rotation matrix using SVD method.
Rotation matrix (SVD method):
[[ 2.31654377e-01 -4.54034191e-02  9.71738020e-01]
 [ 1.06220955e-02  9.98968728e-01  4.41435243e-02]
 [-9.72740161e-01  9.58534024e-05  2.31897758e-01]]
Subtask 3.5: Converting TRIAD and SVD DCMs to quaternions.
Quaternion (TRIAD, Case 1): [ 0.78525537 -0.01405298  0.61875549  0.01783675]
TRIAD initial attitude (deg): roll=0.001 pitch=76.474 yaw=2.603
Quaternion (SVD, Case 1): [ 0.78462107 -0.0140347   0.61955964  0.01785114]
Quaternion (TRIAD, Case 2): [ 0.78525537 -0.01405298  0.61875549  0.01783675]
Quaternion (SVD, Case 2): [ 0.78462107 -0.0140347   0.61955964  0.01785114]

Attitude errors using reference vectors:
TRIAD      -> Gravity error (deg): 0.000023
TRIAD      -> Earth rate error (deg):  0.234815
Davenport  -> Gravity error (deg): 0.000023
Davenport  -> Earth rate error (deg):  0.234815
SVD        -> Gravity error (deg): 0.117419
SVD        -> Earth rate error (deg):  0.117419
Subtask 3.6: Validating attitude determination and comparing methods.

Detailed Earth-Rate Errors:
  TRIAD     : 0.234815°
  Davenport : 0.234815°
  SVD       : 0.117419°

Earth-rate errors by method:
  TRIAD     : 0.234815207°
  Davenport : 0.234815207°
  SVD       : 0.117419345°
  Δ = 1.17e-01° (tolerance = 1.0e-05)


==== Method Comparison for Case X001 and Case X001_doc ====
Method       Gravity Err (deg)    Earth-Rate Err (deg)
TRIAD                   0.0000                  0.2348
Davenport               0.0000                  0.2348
SVD                     0.1174                  0.1174
Subtask 3.7: Plotting validation errors and quaternion components.
Error comparison plot saved
Quaternion comparison plot saved
Subtask 3.8: Storing rotation matrices for use in later tasks.
Task 3 results stored in memory: ['TRIAD', 'Davenport', 'SVD']
TASK 4: GNSS and IMU Data Integration and Comparison
Subtask 4.1: Accessing rotation matrices from Task 3.
Rotation matrices accessed: ['SVD']
Subtask 4.3: Loading GNSS data.
Subtask 4.4: Extracting relevant columns.
GNSS data shape: (1250, 3)
Subtask 4.5: Defining reference point.
Reference point: lat=-0.556257 rad, lon=2.329243 rad, r0=[-3729051.70953389  3935675.21436999 -3348392.35045077]
Subtask 4.6: Computing ECEF to NED rotation matrix.
ECEF to NED rotation matrix computed.
NED to ECEF rotation matrix computed.
Subtask 4.7: Converting GNSS data to NED frame.
GNSS velocity incorporated: [ 0.07577281 -0.01497924  0.1973064 ]
GNSS data transformed to NED frame.
Subtask 4.8: Estimating GNSS acceleration in NED.
GNSS acceleration estimated in NED frame.
Subtask 4.9: Loading IMU data and correcting for bias for each method.
Method SVD: Accelerometer bias: [-0.00460607  0.00091133 -0.01951514] (|b|=0.020072 m/s^2)
Method SVD: Gyroscope bias: [-1.22249608e-07  5.94463653e-09 -1.05110751e-07]
Method SVD: Accelerometer scale factor: 1.0000
IMU data corrected for bias for each method.
Accelerometer scale factor applied: 1.0000
Task 4: applied accelerometer scale factor = 1.0000
Subtask 4.10: Setting IMU parameters and gravity vector.
Using gravity vector from Task 1: [0.         0.         9.79424753]
Subtask 4.11: Initializing output arrays.
Subtask 4.12: Integrating IMU accelerations for each method.
Integrating IMU data using SVD method.
IMU-derived position, velocity, and acceleration computed for all methods.
Subtask 4.13: Validating and plotting data.
Comparison plot in NED frame saved
Plotting data in mixed frames.
Mixed frames plot saved
Plotting all data in NED frame.
All data in NED frame plot saved
Plotting all data in ECEF frame.
All data in ECEF frame plot saved
Plotting all data in body frame.
All data in body frame plot saved
Task 5: Sensor Fusion with Kalman Filter
Subtask 5.1: Configuring logging.
Subtask 5.3: Loading GNSS and IMU data.
Method SVD: Bias computed: [ 0.57290414 -6.83580159  0.8907941 ]
Method SVD: Scale factor: 1.0000
Subtask 5.4: Integrating IMU data for each method.
Method SVD: IMU data integrated.
[IMU_X002_GNSS_X002 | SVD] Final integrated NED velocity: [-1180.458, 8434.896, -1048.948] m/s
Subtask 5.6: Running Kalman Filter for sensor fusion for each method.
Adjusted Q[3:6,3:6]: [[0.1 0.  0. ]
 [0.  0.1 0. ]
 [0.  0.  0.1]]
Adjusted R[3:6,3:6]: [[0.25 0.   0.  ]
 [0.   0.25 0.  ]
 [0.   0.   0.25]]
Velocity blew up (500.1 m/s); zeroing Δv and continuing.
Method SVD: Kalman Filter completed. ZUPTcnt=479587
Method SVD: velocity blow-up events=9662
Subtask 5.7: No event handling needed as time < 5000s.
Subtask 5.8.2: Plotting results for SVD.
Subtask 5.8.2: Plotted SVD position North: First = 0.0000, Last = 18786.8639
Subtask 5.8.2: Plotted SVD position East: First = 0.0000, Last = 326.1563
Subtask 5.8.2: Plotted SVD position Down: First = 0.0000, Last = -32273.1875
Subtask 5.8.2: Plotted SVD velocity North: First = 0.0758, Last = 0.3643
Subtask 5.8.2: Plotted SVD velocity East: First = -0.0150, Last = 0.0050
Subtask 5.8.2: Plotted SVD velocity Down: First = 0.1973, Last = -0.5273
Subtask 5.8.2: Plotted SVD acceleration North: First = 0.0000, Last = -1.7995
Subtask 5.8.2: Plotted SVD acceleration East: First = 0.0000, Last = 6.7566
Subtask 5.8.2: Plotted SVD acceleration Down: First = 0.0000, Last = 12.1093
Subtask 5.8.2: SVD plot saved as 'results/IMU_X002_GNSS_X002_SVD_task5_results_SVD.pdf'
Plotting fused data in mixed frames.
Fused mixed frames plot saved
Plotting all data in NED frame.
All data in NED frame plot saved
Plotting all data in ECEF frame.
All data in ECEF frame plot saved
Plotting all data in body frame.
All data in body frame plot saved
[SUMMARY] method=SVD       imu=IMU_X002.dat gnss=GNSS_X002.csv rmse_pos=   0.29m final_pos=   0.00m rms_resid_pos=   0.08m max_resid_pos=   1.43m rms_resid_vel=  54.58m max_resid_vel= 872.11m accel_bias=0.0201 gyro_bias=0.0000 ZUPT_count=479587 GravErrMean_deg=0.039155 GravErrMax_deg=0.117419 EarthRateErrMean_deg=0.195683 EarthRateErrMax_deg=0.234815
